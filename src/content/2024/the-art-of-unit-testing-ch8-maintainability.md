---
title: é–±è®€ç­†è¨˜ï¼šThe Art of Unit Testing Chapter 8 Maintainability
date: 2024-01-27 20:20:34
tag:
	- [Testing]
banner: /2024/the-art-of-unit-testing-ch8-maintainability/todd-quackenbush-IClZBVw5W5A-unsplash.jpg
summary: æœ¬æ›¸ä»¥ã€Œå–®å…ƒæ¸¬è©¦è¢«ä¿®æ”¹çš„é »ç‡ã€ä¾†è¡¡é‡è©²æ¸¬è©¦çš„å¯ç¶­è­·æ€§ï¼ˆmaintainabilityï¼‰ã€‚ä¿®æ”¹çš„æ¬¡æ•¸è¶Šå°‘ï¼Œç¶­è­·æ€§å°±è¶Šé«˜ã€‚è€Œé€™ä¾¿æ˜¯æœ¬ç¯‡ç­†è¨˜çš„ä¸»é¡Œâ€”â€”å¦‚ä½•å¯«å‡ºå¥½ç¶­è­·çš„æ¸¬è©¦ï¼ˆå¦‚ä½•é¿å…å‹•ä¸å‹•å°±è¦ä¿®æ”¹æ¸¬è©¦ï¼‰ã€‚
draft: 
---

## ç°¡ä»‹

æœ¬æ›¸ä»¥ã€Œå–®å…ƒæ¸¬è©¦è¢«ä¿®æ”¹çš„é »ç‡ã€ä¾†è¡¡é‡è©²æ¸¬è©¦çš„å¯ç¶­è­·æ€§ï¼ˆmaintainabilityï¼‰ã€‚ä¿®æ”¹çš„æ¬¡æ•¸è¶Šå°‘ï¼Œç¶­è­·æ€§å°±è¶Šé«˜ã€‚

> Maintainability is a measure of **how often we are forced to change the tests**. Weâ€™d like to minimize the number of times that happens.

è€Œé€™ä¾¿æ˜¯æœ¬ç¯‡ç­†è¨˜çš„ä¸»é¡Œâ€”â€”å¦‚ä½•å¯«å‡ºå¥½ç¶­è­·çš„æ¸¬è©¦ï¼ˆå¦‚ä½•é¿å…å‹•ä¸å‹•å°±è¦ä¿®æ”¹æ¸¬è©¦ï¼‰ã€‚

## ä½•æ™‚éœ€è¦ä¿®æ”¹æ¸¬è©¦

ç­”ï¼šæ¸¬è©¦æ²’éçš„æ™‚å€™ ğŸ¤¡

èªªçœŸçš„ï¼Œé™¤äº†æ¸¬è©¦å¤±æ•—ï¼Œèª°æ²’äº‹æœƒå»å‹•æ¸¬è©¦ï¼Ÿè€Œæ¸¬è©¦æœƒå¤±æ•—é™¤äº† [7 Trustworthy tests#ç‚ºä½•æ¸¬è©¦æœƒç´…ç‡ˆ](/2024/the-art-of-unit-testing-ch7-trustworthy-tests#ç‚ºä½•æ¸¬è©¦æœƒç´…ç‡ˆ) æéçš„ç†ç”±ä»¥å¤–ï¼Œå…¶å¯¦é‚„æœ‰æœ€å¾Œä¸€ç¨®~~å››å¤§å¤©ç‹æœ‰äº”å€‹äººæ˜¯å¸¸è­˜~~â€”â€”æ¸¬è©¦æœ¬èº«çš„é‚è¼¯æ²’æœ‰å•é¡Œï¼Œå–®å…ƒæƒ³å¯¦ç¾çš„å…§å®¹ä¹Ÿæ²’æœ‰è®Šï¼Œä½†å–®å…ƒçš„ã€Œä½¿ç”¨æ–¹å¼ã€è®Šäº†ï¼Œå°è‡´æ¸¬è©¦ä¹Ÿéœ€è¦è¢«ä¿®æ”¹ã€‚

æœ¬æ›¸èªç‚ºä¸€å€‹å¥½ï¼ˆç¶­è­·ï¼‰çš„å–®å…ƒæ¸¬è©¦è¦ç›¡é‡é™ä½é€™é¡ä¿®æ”¹çš„æ¬¡æ•¸ã€‚è€Œè¦é”æˆé€™å€‹ç›®æ¨™ï¼Œè«‹åœ¨æ’°å¯«å–®å…ƒæ¸¬è©¦æ™‚ç§‰æŒä»¥ä¸‹å…©é»è¦è¨£ï¼š

- é€éå·¥å» åŠŸèƒ½ç®¡ç†é‡è¤‡å…§å®¹
- ä¸è¦é©—è­‰å¯¦ä½œç´°ç¯€

## å¦‚ä½•å¯«å‡ºå¥½ç¶­è­·çš„æ¸¬è©¦

### å–„ç”¨å·¥å» åŠŸèƒ½ï¼ˆfactory functionï¼‰

è©³ç´°æ“ä½œæ–¹å¼å¯ä»¥å›é ­ç¿» [2 A first unit test#2.7 Trying the factory method route](/2023/the-art-of-unit-testing-ch2-a-first-unit-test#27-trying-the-factory-method-route)ã€‚é‡é»å›é¡§å¦‚ä¸‹ï¼š

å°‡ã€Œå•Ÿå‹•å–®å…ƒçš„æ­¥é©Ÿã€é›†ä¸­åˆ°å·¥å» åŠŸèƒ½çš„å¥½è™•æ˜¯ï¼Œç•¶å•Ÿå‹•å–®å…ƒçš„æ–¹æ³•è®Šäº†ï¼Œæˆ‘å€‘åªè¦å»ä¿®æ”¹ã€Œå•Ÿå‹•å–®å…ƒçš„å·¥å» åŠŸèƒ½ã€å°±å¥½ã€‚ä¸éœ€è¦æµ·å·¡è©²å–®å…ƒçš„æ‰€æœ‰æ¸¬è©¦ã€‚

é™¤æ­¤ä¹‹å¤–ï¼Œã€Œé è¨­å–®å…ƒçš„æ¸¬è©¦æƒ…å¢ƒã€ä¹Ÿå¾ˆé©åˆé€éå·¥å» åŠŸèƒ½é›†ä¸­ç®¡ç†ã€‚é™¤äº†è²«å¾¹ [DRY](https://en.wikipedia.org/wiki/Don%27t_repeat_yourself) ä»¥å¤–ï¼Œé™ä½è¨­å®šæƒ…å¢ƒçš„éº»ç…©åº¦ä¹Ÿèƒ½æ¸›å°‘æ¸¬è©¦ä¹‹é–“çš„ä¾è³´æ€§ã€‚

æƒ³åƒä¸€ä¸‹ï¼šä½ æ²’æœ‰ä½¿ç”¨å·¥å» åŠŸèƒ½ä¾†è¨­å®šæ¸¬è©¦æƒ…å¢ƒï¼Œä½†åˆä¸æƒ³åœ¨ä¸‰çµ„æ¸¬è©¦è£¡é‡è¤‡ã€Œç”¢å‡ºç‰¹å®šçµæœã€çš„ç¨‹å¼ç¢¼ã€‚æ–¼æ˜¯ä½ æ±ºå®šåœ¨ç¬¬ä¸€çµ„æ¸¬è©¦è£¡ç”¢å‡ºã€é©—è­‰é€™å€‹çµæœï¼Œå°‡å®ƒä¿å­˜åˆ°å…¨åŸŸè®Šæ•¸è£¡ï¼Œå†ä½¿ç”¨é€™å€‹å€¼ä¾†åŸ·è¡Œå¾ŒçºŒçš„æ¸¬è©¦ã€‚

ä¸å¹¸çš„äº‹ç™¼ç”Ÿäº†â€”â€”ç¬¬ä¸€çµ„æ¸¬è©¦æ²’éï¼Œç„¶å¾Œç¬¬äºŒã€ä¸‰çµ„æ¸¬è©¦ä¹Ÿè·Ÿè‘—å¤±æ•—äº†ã€‚ä½†ä½ ç„¡æ³•é¦¬ä¸Šç¢ºèªå¾Œå…©çµ„æ¸¬è©¦å¤±æ•—çš„ç†ç”±æ˜¯ã€Œç¬¬ä¸€çµ„æ¸¬è©¦æ²’éã€é‚„æ˜¯ã€Œé€™å…©çµ„æ¸¬è©¦é©—è­‰çš„é€€å‡ºé»çœŸçš„æœ‰å•é¡Œã€ã€‚æ›´åˆ¥èªªé€™ç¨®å¯«æ³•é‚„æœ‰ä¸€å€‹å¤§å‰æï¼Œé‚£å°±æ˜¯ä½ å¾—ç¢ºä¿é€™ä¸‰çµ„æ¸¬è©¦æ°¸é è¦ä¾åºåŸ·è¡Œã€‚

æ¯”è¼ƒå¥½çš„åšæ³•æ˜¯ï¼Œé€éå·¥å» åŠŸèƒ½ä¾†ç”¢å‡ºã€ŒåŸ·è¡Œæ¸¬è©¦æ™‚å¿…è¦çš„å€¼ã€ï¼Œè®“ç¬¬äºŒã€ä¸‰çµ„æ¸¬è©¦ä¸éœ€è¦é—œæ³¨ç¬¬ä¸€çµ„æ¸¬è©¦çš„å…§å®¹â€”â€”é”æˆã€Œæ¯ä¸€çµ„æ¸¬è©¦å®Œå…¨ç¨ç«‹ï¼Œä¸å—å½¼æ­¤å½±éŸ¿ã€çš„ç›®æ¨™ã€‚

### ä¸è¦é©—è­‰å¯¦ä½œç´°ç¯€

å¦‚é¡Œï¼Œä¸è¦ç‚ºå¯¦ä½œç´°ç¯€ï¼ˆæ¯”å¦‚ class private propertyï¼‰æ’°å¯«æ¸¬è©¦ã€‚è«‹å°ˆå¿ƒæª¢æŸ¥é€€å‡ºé»ï¼ˆå›å‚³çš„å€¼ã€æ”¹è®Šçš„ç‹€æ…‹ã€æ˜¯å¦æœ‰å‘¼å«ç¬¬ä¸‰æ–¹å¥—ä»¶ï¼‰å³å¯ã€‚

> If you test only the private method and it works, that **doesn't mean that the rest of the system is using this private method correctly** or handles the results it provides correctly.

ç•¶ä½ ç¢ºèªä¸€å€‹å–®å…ƒçš„åŠŸèƒ½æ­£ç¢ºæ™‚ï¼Œå°±ä»£è¡¨è©²å–®å…ƒçš„å¯¦ä½œç´°ç¯€å¿…å®šä¹Ÿæ˜¯æ­£ç¢ºçš„ã€‚åä¹‹ï¼Œå³ä½¿ä½ ç¢ºèªæŸæ®µå¯¦ä½œç´°ç¯€çš„è¡Œç‚ºç¬¦åˆé æœŸï¼Œä¹Ÿç„¡æ³•ä¿è­‰ä¸€å€‹å–®å…ƒã€Œæœ‰æ­£ç¢ºåœ°ä½¿ç”¨è©²å¯¦ä½œç´°ç¯€ã€â€”â€”è¦ç¢ºä¿ä¸€å€‹å–®å…ƒçš„è¡Œç‚ºç¬¦åˆé æœŸï¼Œé‚£å°±å°ˆæ³¨æ–¼é©—è­‰å–®å…ƒçš„é€€å‡ºé»å°±å¥½ã€‚

## åƒè€ƒæ–‡ä»¶

- [Manning: The Art of Unit Testing, Third Edition](https://www.manning.com/books/the-art-of-unit-testing-third-edition)
