---
import PostItem from "@Components/element/PostItem.astro";
import Html from "@Components/layout/Html.astro";
import { ALL_SORTED_POSTS, ALL_UNIQUE_TAGS, getFlatTags } from "@Tools/post";

export async function getStaticPaths() {
  return ALL_UNIQUE_TAGS.map((tag) => ({ params: { tag } }));
}

const { tag } = Astro.params;
const posts = ALL_SORTED_POSTS.filter((post) =>
  getFlatTags(post.data.tag).includes(tag),
);
---

<Html>
  <ul class="flex flex-col gap-8">
    {posts.map((post) => <PostItem post={post} />)}
  </ul>
</Html>
