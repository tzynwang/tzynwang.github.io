---
layout: '@Components/SinglePostLayout.astro'
title: MOPCON 2021 ç¬¬äºŒå¤©ä¹‹å‰ç«¯é–‹ç™¼ç›¸é—œå…§å®¹ä¹‹è­°ç¨‹ç­†è¨˜
date: 2021-10-24 11:46:28
tag:
  - [Web performance]
---

## ç¸½çµ

æ•´ç†äº† 2021 MOPCON ç¬¬äºŒå¤©èˆ‡å‰ç«¯é–‹ç™¼ç›¸é—œè­°ç¨‹ï¼ˆåŒ…å«å¿ƒæ³•èˆ‡æŠ€è¡“é¢å‘ï¼‰çš„ç­†è¨˜èˆ‡å»¶ä¼¸åƒè€ƒè³‡æ–™

## é¢å°å­¸ä¸å®Œçš„æŠ€è¡“ï¼Œå·¥ç¨‹å¸«è©²å¦‚ä½•è‡ªæ•‘

> é‡é»ï¼šä¿æŒå¥½å¥‡å¿ƒï¼Œæ ¹æ“šè‡ªå·±çš„éœ€æ±‚ä¾†å­¸ç¿’ï¼Œä¸¦åŸ¹é¤Šèƒ½åˆ¤æ–·ä»»å‹™å„ªå…ˆåº¦çš„èƒ½åŠ›

- å°ç£çš„å­¸æ ¡æä¾›çš„æ˜¯çµæ§‹æ€§ï¼ˆstructuralï¼‰çš„å­¸ç¿’æ–¹å¼ï¼Œç„¶è€Œéçµæ§‹æ€§ï¼ˆunstructuredï¼‰çš„å­¸ç¿’èƒ½åŠ›æœ‰å…¶å¿…è¦æ€§
  - çµæ§‹æ€§çš„å­¸ç¿’ï¼šé€éå·²ç¶“å®‰æ’å¥½çš„èª²ç¶±æˆ–æ•™æã€æ•™ç§‘æ›¸æˆ–å½±ç‰‡ä¾†å­¸ç¿’ä¸€ç§‘ç›®
  - éçµæ§‹æ€§çš„å­¸ç¿’ï¼šï¼ˆä»¥å‰ç«¯é–‹ç™¼ä¾†èªªï¼‰è‡ªè¡Œé–±è®€åŸå§‹ç¢¼æˆ–å®˜æ–¹æ–‡ä»¶ä¾†æŒæ¡ä¸€é–€æ–°æŠ€è¡“ï¼›å¦‚æœä¸€ç›´æƒ³è¦èµ°åœ¨æŠ€è¡“çš„æœ€å‰ç·šï¼Œéçµæ§‹æ€§çš„å­¸ç¿’èƒ½åŠ›æ˜¯å¿…è¦çš„ï¼Œå› ç‚ºä½ å¿…é ˆåœ¨å…¶ä»–äººå¹«ä½ æ•´ç†å¥½è³‡æ–™ä¹‹å‰å°±è‡ªè¡Œæƒ³è¾¦æ³•å¸æ”¶ã€å…§åŒ–ä¸€é–€çŸ¥è­˜
- å¦‚ä½•åˆ¤æ–·æ˜¯å¦éœ€å­¸ç¿’ä¸€å€‹æ–°æŠ€è¡“ï¼Ÿ
  - ä»¥é–‹æºå°ˆæ¡ˆä¾†èªªï¼šåƒè€ƒ GitHub repo çš„æ´»çµ¡ç¨‹åº¦ï¼ˆæ˜Ÿæ˜Ÿæ•¸èˆ‡æäº¤çš„æ›´æ–°é »ç‡ï¼‰ã€ç¤¾ç¾¤æ´»èºç¨‹åº¦
  - è©•ä¼°è©²æŠ€è¡“çš„å‰ç»æ€§ï¼šåŒ…å«ä½¿ç”¨è©²æŠ€è¡“çš„å¿…è¦æ€§ï¼Œä»¥åŠè©²æŠ€è¡“çš„ç©©å®šç¨‹åº¦
  - å¦‚æœæ˜¯æœ‰èˆˆè¶£çš„æ–°æŠ€è¡“é‚£ç•¶ç„¶å¯ä»¥æ·±å…¥é‘½ç ”ï¼Œç‚ºæ–°è€Œæ–°å‰‡æ²’æœ‰å¿…è¦ï¼›æ‹‹é–‹æ™‚é–“ä¸Šçš„ç„¦æ…®æ„Ÿä¾†é‘½ç ”ä¸€é–€ç§‘ç›®ï¼Œè€Œä¸æ˜¯é›¨éœ²å‡éœ‘
- éå»çš„ç¿’æ…£å¯èƒ½æ˜¯ã€Œå…ˆå­¸å¥½å­¸å®Œã€å†ä¸Šæˆ°å ´ã€ï¼Œä½†æ…¢æ…¢åœ°è®Šæˆã€Œç™¼ç¾è‡ªå·±æ¬ ç¼ºä»€éº¼èƒ½åŠ›ï¼Œæ ¹æ“šé€™äº›ä¸è¶³ä¾†é€²è¡Œè£œå¼·ã€
- åœ¨é€™å€‹é«˜åº¦åˆ†å·¥çš„å¹´ä»£ï¼Œå¦‚ä½•æ‰¾åˆ°éšŠå‹ï¼Ÿ
  - åƒåŠ ç¤¾ç¾¤ï¼Œå¤šäº¤æœ‹å‹ï¼Œèˆ‡ä»–å€‘äº¤æ›ç¤¾ç¾¤å¸³è™Ÿï¼›ä½ ä¸ä¸€å®šè¦è¦ªè‡ªç ”ç©¶æ‰€æœ‰é ˜åŸŸï¼Œä½†çœ‹çœ‹äººå®¶åœ¨ä»–çš„å°ˆæ¥­é ˜åŸŸä¸­æœ‰ä»€éº¼æ–°åˆ†äº«ï¼Œè€Œä½ å°±å¯ä»¥è—‰æ­¤æ”¶ç©«æ–°çŸ¥
- å¥½çš„å·¥ç¨‹å¸«æ‡‰åŸ¹é¤Šå‡ºå¯ä»¥åˆ¤æ–·ä»»å‹™è¼•é‡ç·©æ€¥çš„èƒ½åŠ›ï¼Œæ ¹æ“šè‡ªå·±çš„å°ˆæ¥­çŸ¥è­˜é æ¸¬æœªä¾†å¯èƒ½æœƒé‡åˆ°çš„æŒ‘æˆ°
- è®“è‡ªå·±ä¿æŒå¥½å¥‡å¿ƒã€è¸å‡ºèˆ’é©åœˆï¼Œä½†ä¹Ÿä¸ç”¨ä¸€ç›´å¾…åœ¨è®“è‡ªå·±èº«å¿ƒç–²ä¹çš„æ ¸çˆ†åœˆ

## å ±ç¨…æ‰‹æ©Ÿç‰ˆçš„ UX å„ªåŒ–èˆ‡ JTBD çš„ç”¨æ³•å¯¦è¸

> é‡é»ï¼šå°ˆæ¡ˆåœ¨é–‹ç™¼çš„å„å€‹éšæ®µå°±é »ç¹å°å…¥æ˜“ç”¨æ€§æ¸¬è©¦ï¼ˆusability testï¼‰ä¾†ç¢ºä¿æœ€çµ‚æˆæœçœŸçš„å¯ä»¥æœå‹™åˆ°ä½¿ç”¨è€…

- JTBD: Jobs to be Done
- Jobs Storyï¼šæ ¹æ“šä½¿ç”¨è€…ã€Œè¦è§£æ±ºçš„å•é¡Œã€ä¾†ç ”è¨‚é–‹ç™¼ç­–ç•¥ï¼ˆä½†ä¸¦ä¸æ˜¯æ¨æ£„ user storyï¼‰ï¼Œè¨­è¨ˆå‡ºã€Œä½¿ç”¨è€…åœ¨æ“ä½œç”¢å“å®Œæˆä»»å‹™æ™‚å¯ä»¥æ„Ÿåˆ°æ»¿è¶³ã€çš„è§£æ±ºæ–¹æ¡ˆ

![user story, job story](/2021/mopcon-2021-d2-note/user-story-job-story.png)

- å¦‚ä½•è®“ä½¿ç”¨è€…è¦ºå¾—ä½ çš„æœå‹™å€¼å¾—ä¿¡è³´ï¼Ÿ
  - ã€Œåœ¨æ¯ä¸€å€‹å°çš„æ™‚é–“ï¼Œæä¾›å°çš„æ„Ÿå—é«”é©—ã€
  - ä¿¡ä»»ä¸æ˜¯çªç„¶ã€è‡ªç„¶ç™¼ç”Ÿçš„
- ä¿¡ä»»æ˜¯é€éä»€éº¼æ¨£çš„é«”é©—ç´¯ç©è€Œæˆï¼Ÿ
  - é«”è²¼æ„Ÿï¼šé å…ˆè¨­æƒ³ä½¿ç”¨è€…**å¯èƒ½æœƒåœ¨å“ªè£¡çŠ¯éŒ¯**ï¼Œä¸¦**é å…ˆé¿å…éŒ¯èª¤ç™¼ç”Ÿ**ï¼ˆæ›¿ä½¿ç”¨è€…æƒ³å¥½ä¸‹ä¸€æ­¥ï¼‰
  - ç†Ÿæ‚‰æ„Ÿï¼šä»¥ç›¸ä¼¼çš„æ–¹å¼**é¡æ¯”**ï¼Œæ¸›å°‘å­¸ç¿’æ›²ç·šï¼›æä¾›è¦–è¦ºä¸Šå…·æœ‰**ä¸€è‡´æ€§**çš„å…ƒä»¶èˆ‡ç•«é¢ï¼Œé™ä½èªçŸ¥è² è·ï¼›è®“ä½¿ç”¨è€…ä»¥ç†Ÿæ‚‰çš„æ–¹å¼é€²è¡Œäº’å‹•
  - å°ˆæ¥­æ„Ÿï¼šæŠŠè¤‡é›œçš„ä»»å‹™**ç°¡åŒ–**ã€è®“ä½¿ç”¨è€…å¯ä»¥è¼•æ˜“ç†è§£ç¾åœ¨ç™¼ç”Ÿä»€éº¼äº‹ï¼›é¿å…ä½¿ç”¨ä½¿ç”¨è€…ä¸æ¸…æ¥šçš„å°ˆæ¥­è¡“èª
  - å®‰å…¨æ„Ÿï¼šäº†è§£ä½¿ç”¨è€…ä¸€é–‹å§‹æŒæœ‰çš„é æœŸï¼Œèª¿æ•´ä½¿ç”¨è€…å°ç³»çµ±çš„é æœŸèªçŸ¥ï¼Œ**å¢åŠ ä½¿ç”¨è€…å°ç³»çµ±åŠŸèƒ½èˆ‡æµç¨‹çš„æŒæ¡ç¨‹åº¦**
- åœ¨æ¯ä¸€å€‹é–‹ç™¼éšæ®µï¼ˆwireframe æ™‚ã€è¦–è¦ºè¨­è¨ˆæ™‚ã€é–‹ç™¼æ™‚ï¼‰éƒ½å°å…¥æ˜“ç”¨æ€§æ¸¬è©¦
- çµè«–ï¼š
  - è¦äº†è§£ç”¢å“æ˜¯è¦å¹«ä½¿ç”¨è€…è§£æ±ºä»€éº¼å•é¡Œï¼Ÿ
  - ä»¥ä½¿ç”¨è€…çš„å•é¡Œç‚ºæ ¸å¿ƒå±•é–‹é–‹ç™¼ï¼Œæ‰€æœ‰çš„è¨­è¨ˆæŒ‡å‘ä¸€è‡´ç›®æ¨™
  - æŒçºŒç™¼ç¾å•é¡Œï¼Œä¸¦åŠæ—©è§£æ±ºå•é¡Œ

## ç®—å­—æ•¸è€Œå·²ï¼Œç‚ºä½•å¦‚æ­¤éº»ç…©ï¼Ÿ â€”â€” å¾ Unicode æ¨™æº–çœ‹ Emoji å’Œå¤šèªç³»çš„çµ„åˆæŠ€

```js
'å¥½'.length
// 1
'ğªš¥'.length
// 2
'ğŸ¤”'.length
// 2
'ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦â€ğŸ‘¦'.length
// 11

'ğŸ’©' == '\uD83D\uDCA9'
// true

[...'ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦â€ğŸ‘¦']
// ['ğŸ‘¨', 'â€', 'ğŸ‘©', 'â€', 'ğŸ‘¦', 'â€', 'ğŸ‘¦']
```

![emoji](/2021/mopcon-2021-d2-note/know-something-strange.jpg)

- ç‚ºä»€éº¼åœ¨ç”¨ length è¨ˆç®—å­—æ•¸çš„æ™‚å€™æœƒå‡ºç¾ä¸Šè¿°çµæœï¼Ÿ
  - `length`é•·åº¦è¶…é 1 ä»£è¡¨èƒŒå¾Œæ˜¯ç”±å¤šå€‹ unicode codepoints çµ„åˆè€Œæˆ
  - JavaScript çš„`str.length`å›å‚³çš„æ˜¯ str ä»¥ UTF-16 ç·¨ç¢¼çš„å–®ä½æ•¸é‡
    > [MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/length): The length property of a String object contains the length of the string, in **UTF-16 code units**.
- Surrogate Pairï¼šã€Œä»£ç†å°ã€
  - ğŸ’© å¯ä»¥æ‹†ç‚º`U+D83D`èˆ‡`U+DCA9`çš„çµ„åˆï¼Œé€™å°±æ˜¯ä¸€çµ„ä»£ç†å°
- è§£æ±ºæ–¹å¼ï¼šæ”¹ç‚ºè¨ˆç®—ã€Œgrapheme clusterï¼ˆå­—ä½ã€å½¢ç´ ã€å­—ç´ ï¼‰ã€çš„æ•¸é‡
  - grapheme clusterï¼šæœ€å°çš„æœ‰æ„ç¾©æ›¸å¯«ç¬¦è™Ÿå–®ä½ï¼ˆå¼•è‡ªç¶­åŸºç™¾ç§‘ï¼‰
  - JavaScript ç›®å‰å¯ä»¥é  Lodash ä¸­çš„[toArray](https://lodash.com/docs#toArray)ä¾†å¹«å¿™è™•ç†
    è§£æ³•ä¾†è‡ª[Why is "ğŸ‘".length === 2?](https://stackoverflow.com/a/46085089/15028185)
    ```js
    _.toArray('ğŸ¤”').length; // --> 1
    ```
- å»¶ä¼¸é–±è®€ï¼š
  - [Emoji String Length, Issues with Rounded Buttons, Bundled Exchanges](https://css-tricks.com/weekly-platform-news-emoji-string-length-issues-with-rounded-buttons-bundled-exchanges/)
  - [åœ¨ç¨‹å¼è£¡ç®— Emoji å­—æ•¸çš„é‚£äº›å•é¡Œ](https://medium.com/dcardlab/%E5%9C%A8%E7%A8%8B%E5%BC%8F%E8%A3%A1%E7%AE%97-emoji-%E5%AD%97%E6%95%B8%E7%9A%84%E9%82%A3%E4%BA%9B%E5%95%8F%E9%A1%8C-8e1a1170a499)

## Speed Up Your App with Web Vitals

> ä½¿ç”¨è€…èªç‚ºçš„å¿«ï¼šã€Œå…§å®¹å‡ºç¾çš„é€Ÿåº¦å¿«ã€å›æ‡‰å¿«ã€ç¶²ç«™ç•«é¢ä¸æœƒå¤§å¹…åº¦è®Šå‹•ã€

- Web Vitalsï¼šç”± Google æå‡ºï¼Œæª¢é©—ä¸€å€‹ç¶²ç«™çš„ä½¿ç”¨è€…é«”é©—æ˜¯å¦è‰¯å¥½çš„æ ¸å¿ƒæŒ‡æ¨™
  - [Web Vitals](https://web.dev/vitals/) is an initiative by Google to provide unified guidance for quality signals that are essential to **delivering a great user experience on the web**.
- Core Web Vitalsï¼šç”± LCPã€FID èˆ‡ CLS çµ„æˆ
  - Largest Contentful Paintï¼šæœ€å¤§å…§å®¹å€å¡Šå‡ºç¾çš„æ™‚é–“é»
  - First Input Delayï¼šä½¿ç”¨è€…èˆ‡ç¶²ç«™äº’å‹•å¾Œï¼Œç¶²ç«™**çœŸæ­£å›æ‡‰ä½¿ç”¨è€…çš„æ™‚é–“å·®**
    èˆ‰ä¾‹ï¼šåœ¨ç¶²ç«™çš„æœå°‹æ¬„ä½æ‰“å­—ï¼Œè€Œç¶²ç«™çœŸçš„æŠŠä½¿ç”¨è€…è¼¸å…¥çš„å…§å®¹å‘ˆç¾åœ¨è¼¸å…¥æ¡†å…§çš„æ™‚é–“å·®
  - Cumulative Layout Shiftï¼šï¼ˆè¼‰å…¥å®Œç•¢å¾Œï¼Œæ•´é«”ï¼‰ç‰ˆé¢ç§»å‹•çš„å¹…åº¦ï¼Œè©•ä¼°çš„æ˜¯è¦–è¦ºä¸Šçš„**ç©©å®šç¨‹åº¦**
    èˆ‰ä¾‹ï¼šå¦‚æœæœ‰å»£å‘Šæœƒå¤§å¹…æ“ å‹•ç¶²é ç‰ˆé¢ï¼ŒCLS æ•¸å€¼å°±æœƒå¾ˆé«˜
- Other Web Vitalsï¼šå…©é …ï¼ŒFCP èˆ‡ TTFB
  - First Contentful Paintï¼š**ç•«é¢ä¸Šå‡ºç¾ç¬¬ä¸€å€‹åƒç´ **çš„æ™‚é–“é»
  - Time to First Byteï¼šç€è¦½å™¨æ”¶åˆ°è³‡æºçš„ç¬¬ä¸€å€‹æ™‚é–“é»
- é€ æˆç¶²é è¼‰å…¥é€Ÿåº¦ä½è½çš„åŸå› ï¼š
  - æœ‰ rendering blockingï¼ˆç¦æ­¢è½‰è­¯ï¼‰çš„è³‡æºï¼Œæ¯”å¦‚æ²’æœ‰å¿…è¦åœ¨ header å€å¡Šè¼‰å…¥çš„ CSS æˆ– JS å…§å®¹
  - ä¼ºæœå™¨å›æ‡‰é€Ÿåº¦æœ¬ä¾†å°±æ…¢
  - ï¼ˆä¸Šé¢é€™ä¸€é»é€£å¸¶å½±éŸ¿åˆ°ï¼‰è³‡æºè¼‰å…¥çš„é€Ÿåº¦æ…¢
- ï¼ˆèŠå¤©å®¤æ’¿ä¾†çš„è¨è«–ä¸²ï¼‰ã€Œcode-splitting é™¤äº†è¬›è€…æåˆ°çš„åˆ‡ chunk ä»¥å¤–ï¼Œé‚„æœ‰ä»€éº¼å…¶ä»–å¯¦ç¾çš„æ–¹æ³•å—ï¼Ÿã€
  - ä½¿ç”¨ ES import èªæ³•ï¼ˆè€Œé commonJS çš„`require()`ï¼‰ï¼Œå› ç‚ºå…¶åŒ¯å…¥ç›¸å°éœæ…‹çš„ç‰¹æ€§ï¼Œèƒ½æ–¹ä¾¿ webpack æˆ– rollup ç­‰æ‰“åŒ…è»Ÿé«”éæ¿¾æ‰æœªä½¿ç”¨çš„å…§å®¹
  - æ¯”è¼ƒå°‘ä½¿ç”¨çš„ module å¯é…åˆ dynamic import é”æˆã€Œåªæœ‰åœ¨ç”¨åˆ°è©²åŠŸèƒ½çš„æ™‚å€™æ‰é€²è¡ŒåŒ¯å…¥ã€
- è£œå……ï¼š
  - [Code splitting](https://developer.mozilla.org/en-US/docs/Glossary/Code_splitting): splitting of code into various bundles or components which can then **be loaded on demand** or in **parallel**. To prevent the requirement of downloading ginormous files, scripts can be **split into multiple smaller files**. Then features required at page load can be downloaded immediately with additional scripts being lazy loaded after the page or application is interactive, thus **improving performance**. While the total amount of code is the same (and perhaps even a few bytes larger), **the amount of code needed during initial load can be reduced**. å°‡ç¨‹å¼ç¢¼æ‹†åˆ†æˆå°å¡Šï¼Œæª”æ¡ˆåˆè¨ˆç¸½å¤§å°ä¸è®Šï¼Œä½†åœ¨åˆæ¬¡è¼‰å…¥æ™‚éœ€è¦ä¸‹è¼‰çš„æª”æ¡ˆå¤§å°æœƒç¸®æ¸›
  - [Tree shaking](https://developer.mozilla.org/en-US/docs/Glossary/Tree_shaking): a term commonly used within a JavaScript context to describe **the removal of dead code**. It relies on the `import` and `export` statements in ES2015 to detect if code modules are exported and imported for use between JavaScript files. In modern JavaScript applications, we use **module bundlers (e.g., webpack or Rollup) to automatically remove dead code** when bundling multiple JavaScript files into single files. This is important for preparing code that is production ready, for example with **clean structures** and **minimal file size**. æ„å³æŠŠæ²’æœ‰ç”¨åˆ°ç¨‹å¼ç¢¼å…§å®¹æ’é™¤æ‰

## åƒè€ƒæ–‡ä»¶

- [é¢å°å­¸ä¸å®Œçš„æŠ€è¡“ï¼Œå·¥ç¨‹å¸«è©²å¦‚ä½•è‡ªæ•‘](https://mopcon.org/2021/schedule/2021025)
- [iOS éš±ç§èˆ‡ä¾¿åˆ©çš„å‰ä¸–ä»Šç”Ÿ](https://mopcon.org/2021/schedule/2021028)
- [å ±ç¨…æ‰‹æ©Ÿç‰ˆçš„ UX å„ªåŒ–èˆ‡ JBTD çš„ç”¨æ³•å¯¦è¸](https://mopcon.org/2021/schedule/2021034)
- [ç®—å­—æ•¸è€Œå·²ï¼Œç‚ºä½•å¦‚æ­¤éº»ç…©ï¼Ÿ â€”â€” å¾ Unicode æ¨™æº–çœ‹ Emoji å’Œå¤šèªç³»çš„çµ„åˆæŠ€](https://mopcon.org/2021/schedule/2021037)
- [Speed Up Your App with Web Vitals](https://mopcon.org/2021/schedule/2021042)
