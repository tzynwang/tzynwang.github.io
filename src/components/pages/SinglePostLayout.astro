---
import Tag from "@Components/element/Tag.astro";
import Html from "@Components/layout/Html.astro";
import type { EntryData } from "@Models/GeneralTypes";
import { dateFormatter } from "@Tools/formatter";
import { getFlatTags } from "@Tools/post";
import type { MarkdownHeading, MarkdownInstance } from "astro";

interface Props {
  entry: EntryData;
  headings: MarkdownHeading[];
  Content: MarkdownInstance<{}>["Content"];
}

const { entry, headings, Content } = Astro.props;
---

<Html
  title={entry.data.title}
  description={entry.data.summary || ""}
  image={entry.data.banner || ""}
>
  <section class="space-y-8">
    <h1>{entry.data.title}</h1>
    <div class="flex flex-col gap-3">
      <time>{dateFormatter(entry.data.date)}</time>
      <nav class="flex items-center gap-2">
        {getFlatTags(entry.data.tag).map((tag) => <Tag tag={tag}>{tag}</Tag>)}
      </nav>
      <ul class="list-none space-y-1">
        {
          headings.map((head) => (
            <li
              class:list={[
                "block",
                head.depth === 3 && "ml-4",
                head.depth === 4 && "ml-8",
                head.depth === 5 && "ml-12",
              ]}
            >
              <a
                href={`#${head.slug}`}
                class="text-teal-800 dark:text-teal-300"
              >
                {head.text}
              </a>
            </li>
          ))
        }
      </ul>
    </div>
    <article
      class:list={[
        "space-y-6",
        "[&_:is(blockquote)]:border-l-4 [&_:is(blockquote)]:pl-4",
        "[&_:is(ol)]:list-decimal [&_:is(ol,ul)]:list-inside [&_:is(ul)]:list-disc",
        "[&_:is(a)]:text-teal-800 dark:[&_:is(a)]:text-teal-300",
      ]}
    >
      <Content />
    </article>
  </section>
</Html>
